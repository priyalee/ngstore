<app-navbar></app-navbar>
<div class="container mt-5">
  <h2 class="mb-4 text-center">ðŸ›’ Your Carts</h2>

  <!-- Loader -->
  <div *ngIf="isLoading" class="text-center">
    <div class="spinner-border text-primary"></div>
  </div>

  <!-- Cart List -->
  <div *ngIf="!isLoading && carts.length > 0"
       class="row row-cols-1 row-cols-md-3 g-4">

    <div class="col" *ngFor="let c of carts">
      <div class="card shadow-sm">
        <div class="card-body text-center">
          <h5 class="text-primary fw-bold">Cart ID: {{ c.id }}</h5>
          <p>User ID: {{ c.userId }}</p>
          <p class="text-muted">{{ c.date | date:'mediumDate' }}</p>

          <button
            class="btn btn-outline-primary btn-sm"
            (click)="viewCart(c.id)">
            View
          </button>

          <button
            class="btn btn-outline-danger btn-sm ms-2"
            (click)="deleteCart(c.id)">
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Selected Cart -->
  <div *ngIf="selectedCart" class="mt-5">
    <h4 class="text-center">ðŸ§¾ Cart #{{ selectedCart.id }} Details</h4>

    <ul class="list-group mt-3 shadow-sm">
      <li *ngFor="let p of selectedCart.products"
          class="list-group-item d-flex justify-content-between align-items-center">

        <span>
          <strong>Product ID:</strong> {{ p.productId }}
        </span>

        <div class="d-flex align-items-center">
          <button
            class="btn btn-outline-secondary btn-sm"
            (click)="decrease(p)"
            [disabled]="p.quantity === 1 || isUpdating">
            âˆ’
          </button>

          <span class="mx-3 fw-bold">{{ p.quantity }}</span>

          <button
            class="btn btn-outline-secondary btn-sm"
            (click)="increase(p)"
            [disabled]="isUpdating">
            +
          </button>
        </div>
      </li>
    </ul>

    <p *ngIf="isUpdating" class="text-center text-muted mt-2">
      Updating cart...
    </p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && carts.length === 0" class="text-center mt-4">
    <p class="text-muted">No carts available.</p>
  </div>
</div>

